<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Admin — Cortex</title>
<link rel="stylesheet" href="style.css"/>
</head>
<body>

<nav class="nav">
  <div class="inner">
    <div class="logo">Cortex</div>
    <div class="menu">
      <a href="index.html">Início</a>
      <a href="create.html">Create your Bot</a>
      <a href="portfolio.html">Portfólio</a>
      <a href="admin.html" class="cta">Admin</a>
    </div>
  </div>
</nav>

<header class="hero" style="min-height:24vh">
  <img src="hero.png" alt=""/>
  <div class="content">
    <h1>Painel da Equipe</h1>
    <p>Gerencie os projetos que aparecem no portfólio.</p>
  </div>
</header>

<!-- LOGIN -->
<main class="container" id="loginBox">
  <div class="block">
    <h3>Entrar no painel</h3>
    <label class="label">Senha de admin</label>
    <input class="input" id="adminPass" type="password" placeholder="••••••••"/>
    <div style="height:10px"></div>
    <button class="btn" onclick="checkLogin()">Entrar</button>
    <p class="note">Apenas a equipe tem acesso a este painel.</p>
  </div>
</main>

<!-- PAINEL ADMIN -->
<main class="container" id="adminPanel" style="display:none">
  <div class="block">
    <h3>Novo Projeto</h3>
    <label class="label">Nome do projeto</label>
    <input class="input" id="projTitle" placeholder="Ex.: Ticket Bot Premium"/>

    <label class="label">Descrição</label>
    <textarea class="input" id="projDesc" rows="3" placeholder="Descreva o que o bot faz..."></textarea>

    <label class="label">Membro da equipe</label>
    <input class="input" id="projMember" placeholder="Ex.: LucasDev"/>

    <label class="label">Imagem destaque</label>
    <input class="input" type="file" id="projImage" accept="image/*"/>
    <p class="note">ou insira URL:</p>
    <input class="input" id="projImageUrl" placeholder="https://exemplo.com/imagem.jpg"/>

    <label class="label">Vídeo (URL YouTube opcional)</label>
    <input class="input" id="projVideo" placeholder="https://youtu.be/..."/>

    <div style="height:10px"></div>
    <button class="btn" onclick="addProject()">Adicionar ao Portfólio</button>
  </div>

  <div class="block">
    <h3>Projetos atuais</h3>
    <div id="projectList" class="gallery"></div>
  </div>
</main>

<footer class="footer">© Cortex — Discord Bot Store • <span class="note">Painel de administração</span></footer>

<script>
const ADMIN_PASSWORD = "CortexSite123"; // <<< TROQUE AQUI

function checkLogin(){
  const pass = document.getElementById("adminPass").value;
  if(pass === ADMIN_PASSWORD){
    document.getElementById("loginBox").style.display="none";
    document.getElementById("adminPanel").style.display="block";
    renderProjects();
  } else {
    alert("Senha incorreta!");
  }
}

function getProjects(){
  return JSON.parse(localStorage.getItem("portfolio_data") || "[]");
}
function saveProjects(data){
  localStorage.setItem("portfolio_data", JSON.stringify(data));
}

async function addProject(){
  const title = document.getElementById("projTitle").value.trim();
  const desc = document.getElementById("projDesc").value.trim();
  const member = document.getElementById("projMember").value.trim();
  const video = document.getElementById("projVideo").value.trim();
  const file = document.getElementById("projImage").files[0];
  const imgUrl = document.getElementById("projImageUrl").value.trim();

  if(!title || !member) return alert("Preencha título e membro.");

  let imageDataUrl = null;
  if(file){
    imageDataUrl = await new Promise((res,rej)=>{
      const r = new FileReader(); 
      r.onload=()=>res(r.result); 
      r.onerror=rej; 
      r.readAsDataURL(file);
    });
  } else if(imgUrl){
    imageDataUrl = imgUrl;
  }

  const data = getProjects();
  data.push({title, desc, member, imageDataUrl, videoUrl: video});
  saveProjects(data);
  renderProjects();

  // limpar inputs
  document.getElementById("projTitle").value="";
  document.getElementById("projDesc").value="";
  document.getElementById("projMember").value="";
  document.getElementById("projImage").value="";
  document.getElementById("projImageUrl").value="";
  document.getElementById("projVideo").value="";

  alert("Projeto adicionado!");
}

function removeProject(i){
  const data = getProjects();
  data.splice(i,1);
  saveProjects(data);
  renderProjects();
}

function renderProjects(){
  const list = document.getElementById("projectList");
  const data = getProjects();
  if(data.length === 0){
    list.innerHTML = "<p class='note'>Nenhum projeto cadastrado ainda.</p>";
    return;
  }
  list.innerHTML = data.map((p,i)=>`
    <div class="card">
      <img src="${p.imageDataUrl || `assets/thumb${(Math.abs(p.title.length)%4)+1}.jpg`}" alt=""/>
      <h4>${p.title}</h4>
      <p class="note">${p.desc||""}</p>
      <span class="tag">@${p.member}</span>
      ${p.videoUrl ? `<a class="tag" href="${p.videoUrl}" target="_blank">Vídeo</a>` : ""}
      <div style="margin-top:8px"><button class="btn" onclick="removeProject(${i})">Remover</button></div>
    </div>
  `).join("");
}
</script>

</body>
</html>
